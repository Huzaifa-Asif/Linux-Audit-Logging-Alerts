# AWS Infrastructure

This repository contains the Terraform code to set up AWS resources including Lambda functions, CloudWatch log groups, and CloudWatch log subscription filters.

## Resources

The following resources are created by this Terraform module:

1. **Lambda Function (`aws_lambda_function.notification_lambda`)**: This is the main Lambda function that gets triggered based on the CloudWatch log subscription filter. The function is written in Node.js 18.x and its code is located in the `/lambda` directory.

2. **CloudWatch Log Groups (`aws_cloudwatch_log_group.lambda_log_group` and `aws_cloudwatch_log_group.suspicious_command_log_group`)**: These are the log groups where the logs from the Lambda function and suspicious commands are stored.

3. **CloudWatch Log Subscription Filter (`aws_cloudwatch_log_subscription_filter.suspicious_command_lambda_trigger_filter`)**: This filter triggers the Lambda function when a suspicious command is detected in the logs.

4. **Lambda Permission (`aws_lambda_permission.allow_cloudwatch_to_call_lambda`)**: This permission allows CloudWatch Logs to invoke the Lambda function.

## Usage

Before using this module, you need to have Terraform installed. 

For macOS users, you can install Terraform using Homebrew:

```bash
brew install terraform
```

For Windows users, you can install Terraform using Chocolatey:

```bash
choco install terraform
```

For more details on installing Terraform, please visit the [official guide](https://developer.hashicorp.com/terraform/tutorials/aws-get-started/install-cli).

After installing Terraform, you need to configure your AWS credentials. You can do this using the AWS CLI:

```bash
aws configure
```

You will be prompted to enter your AWS Access Key ID, Secret Access Key, default region name, and default output format.

Once Terraform is installed and AWS is configured, you can initialize Terraform and apply the configuration:

- `terraform init`: This command is used to initialize a working directory containing Terraform configuration files. It is the first command that should be run after writing a new Terraform configuration or cloning an existing one from version control.

- `terraform plan`: This command creates an execution plan. It determines what actions are necessary to achieve the desired state specified in the configuration files.

- `terraform apply`: This command applies the changes required to reach the desired state of the configuration, or the pre-determined set of actions generated by a `terraform plan` execution plan.

```bash
terraform init
terraform plan
terraform apply
```

This section provides detailed instructions on how to install Terraform and use it to apply your configuration.

## Variables

The following variables are used in this module:

- `var.environment`: The environment where the resources are being created. This is used to name the resources.

## Contact

For any questions or issues, please contact hello@huzaifa.io.